<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ã„ã‚‹ã‹é›»é‰„</title>
  <link rel="stylesheet" href="style.css">
  <style>
/* === å…±é€šãƒªã‚»ãƒƒãƒˆ === */
* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: "Noto Sans JP", sans-serif;
}

/* === ãƒ˜ãƒƒãƒ€ãƒ¼ === */
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background-color: white;
  padding: 10px 20px;
  flex-wrap: wrap;
}

.header-left {
  display: flex;
  align-items: center;
}

.logo {
  height: 40px;
  margin-right: 10px;
}

.site-name {
  font-size: 20px;
  font-weight: bold;
}

.header-right {
  display: flex;
  flex-wrap: wrap;
}

.header-right a {
  text-decoration: none;
  color: #0055aa;
  margin-left: 10px;
  white-space: nowrap;
}

/* === é§…åæ¤œç´¢ === */
.suggestions {
  position: absolute;
  background-color: white;
  border: 1px solid #ccc;
  width: calc(100% - 20px);
  max-height: 150px;
  overflow-y: auto;
  z-index: 999;
}

.suggestions div {
  padding: 8px;
  cursor: pointer;
}

.suggestions div:hover {
  background-color: #f0f0f0;
}

/* === ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ === */
.slider {
  position: relative;
  max-width: 900px;
  margin: auto;
  overflow: hidden;
  width: 100%;
}

.slider-track {
  display: flex;
  transition: transform 0.5s ease-in-out;
}

.slider-track img {
  width: 100%;
  max-width: 900px;
  height: 500px;
  object-fit: cover;
  flex-shrink: 0;
}

.slider-btn {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  background-color: rgba(0,0,0,0.5);
  color: white;
  border: none;
  padding: 10px 15px;
  cursor: pointer;
  font-size: 18px;
  z-index: 1;
}

.prev-btn { left: 10px; }
.next-btn { right: 10px; }

/* === ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ === */
.tab-buttons {
  display: flex;
  gap: 10px;
  margin-top: 20px;
  flex-wrap: wrap;
}

.tab-button {
  padding: 10px 20px;
  cursor: pointer;
  background-color: #eee;
  border: none;
  flex: 1;
}

.tab-button.active {
  background-color: white;
  color: black;
}

.tab-content {
  display: none;
  margin-top: 10px;
}

.tab-content.active {
  display: block;
}

/* === ç‰¹é›† === */
.feature-section {
  margin: 40px 0;
  text-align: center;
  padding: 0 10px;
}

.feature-content {
  display: flex;
  justify-content: center;
  gap: 20px;
  flex-wrap: wrap;
}

.feature-box {
  border: none;
  background: none;
  text-align: center;
}

.feature-box img {
  height: 100px;
  max-width: 100%;
}

/* === SNSã‚«ãƒ¼ãƒ‰ === */
.sns-hankyu {
  margin-top: 40px;
  padding: 0 10px;
}

.sns-cards {
  display: flex;
  justify-content: center;
  gap: 20px;
  flex-wrap: wrap;
}

.sns-card {
  text-decoration: none;
  background-color: #eeeeee;
  padding: 10px 20px;
  border-radius: 5px;
  color: black;
  width: fit-content;
}

/* === é‹è¡Œæƒ…å ±ã‚¢ãƒ©ãƒ¼ãƒˆ === */
.railinfo-alert {
  background-color: #f8f8f8;
  border-radius: 8px;
  padding: 10px 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border: 2px solid #e4e4e4;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  flex-wrap: wrap;
  gap: 10px;
}

.railinfo-alert p {
  font-size: 16px;
  color: #333333;
  margin: 0;
  display: flex;
  align-items: center;
}

.railinfo-alert img {
  width: 24px;
  height: 24px;
  margin-right: 10px;
}

.railinfo-alert .time {
  font-size: 14px;
  color: #666666;
  font-weight: bold;
}

/* === ã‚­ãƒ¼ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ« === */
.KV_inner.cont {
  position: relative;
  width: 100%;
  overflow: hidden;
  padding: 0;
}

.KV_inner_cnt {
  position: relative;
  text-align: right;
}

.KV_inner_cnt img {
  max-width: 100%;
  height: auto;
  display: block;
}

.KV_inner_cnt .sp {
  display: none;
}

.KV_inner_cnt .pc {
  display: block;
}

/* === ã‚¹ãƒãƒ›å¯¾å¿œ === */
@media screen and (max-width: 768px) {

  .header {
    flex-direction: column;
    align-items: flex-start;
  }

  .header-right {
    margin-top: 10px;
  }

  .slider-track img {
    height: 250px;
  }

  .slider-btn {
    font-size: 14px;
    padding: 8px 10px;
  }

  .tab-button {
    flex: 1 1 100%;
  }

  .feature-box img {
    height: 80px;
  }

  .railinfo-alert {
    flex-direction: column;
    align-items: flex-start;
  }

  .railinfo-alert .time {
    align-self: flex-end;
  }

  .KV_inner_cnt .sp {
    display: block;
  }

  .KV_inner_cnt .pc {
    display: none;
  }
}
/* =========================
   ã‚¹ãƒãƒ›ç”¨ ä¸‹ãƒŠãƒ“
========================= */
.bottom-nav {
  display: none;
}

@media screen and (max-width: 768px) {
  body {
    padding-bottom: 64px;
  }

  .bottom-nav {
    display: flex;
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 64px;
    background: #ffffff;
    border-top: 1px solid #ddd;
    z-index: 2000;
  }

  .bottom-item {
    flex: 1;
    text-align: center;
    text-decoration: none;
    color: #333;
    font-size: 12px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 4px;
  }

  .bottom-item .icon {
    font-size: 20px;
  }

  .bottom-item:active {
    background-color: #f0f0f0;
  }
}
@media screen and (max-width: 768px) {
  .slider-btn {
    padding: 6px 8px;
    font-size: 14px;
  }
}
.hero-wrap {
  display: flex;
  width: 100%;
  max-width: 2100px;
  margin: 0 auto;
}
.image-container.base {
  position: relative;
  width: 100%;
  height: 420px;
  background-image: url("https://irukatrin.dolphin.f5.si/image/Irukaweb%20-%201.png");
  background-size: cover;
  background-position: center;
}
.overlay-image {
  position: absolute;
  top: 0;
  left: 0;
  width: 45%;
  height: 100%;
  background-image: url("https://irukatrin.dolphin.f5.si/image/Irukaweb%20-%202.png");
  background-size: cover;
  background-position: center;
  z-index: 2;
}
.overlay-search {
  position: absolute;
  bottom: 20px;
  left: 20px;
  display: flex;
  z-index: 3;
}

.overlay-search input {
  padding: 14px 16px;
  min-width: 240px;
}

.overlay-search button {
  padding: 14px 16px;
}
@media screen and (max-width: 768px) {
  .image-container.base {
    height: 260px;
  }

  .overlay-image {
    width: 100%;
    height: 100%;
  }

  .overlay-search {
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
  }

  .overlay-search input {
    width: 100%;
  }
}
@media screen and (max-width: 768px) {
  .search-form input,
  .search-form button {
    width: 100%;          /* å¹…ã„ã£ã±ã„ã«ã—ã¦è¦‹ã‚„ã™ã */
    font-size: 18px;      /* æ–‡å­—ã‚’å°‘ã—å¤§ãã */
    padding: 12px 15px;   /* ã‚¿ãƒƒãƒã—ã‚„ã™ã„å¤§ãã• */
  }

  .search-form {
    display: flex;
    flex-direction: column;  /* å…¥åŠ›ã¨ãƒœã‚¿ãƒ³ã‚’ç¸¦ä¸¦ã³ */
    gap: 10px;               /* é–“éš” */
    align-items: center;     /* ä¸­å¤®æƒãˆ */
    position: absolute;      /* ç”»åƒä¸Šã«è¢«ã›ã‚‹ */
    top: 20%;                /* ç”»é¢ä¸Šã‹ã‚‰ã®ä½ç½®èª¿æ•´ */
    left: 50%;
    transform: translateX(-50%);
    z-index: 10;             /* ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚„èƒŒæ™¯ã‚ˆã‚Šå‰é¢ */
  }
}



    
  </style>
</head>
<!-- ã‚¹ãƒãƒ›ç”¨ ä¸‹ãƒŠãƒ“ -->
<nav class="bottom-nav">
  <a href="#" class="bottom-item">
    <span class="icon">ğŸ </span>
    <span class="label">ãƒ›ãƒ¼ãƒ </span>
  </a>
  <a href="unkou" class="bottom-item">
    <span class="icon">ğŸš†</span>
    <span class="label">é‹è¡Œ</span>
  </a>
  <a href="#" class="bottom-item">
    <span class="icon">ğŸ«</span>
    <span class="label">ãƒã‚±ãƒƒãƒˆ</span>
  </a>
  <a href="Pack" class="bottom-item">
    <span class="icon">ğŸ¢</span>
    <span class="label">ä¼šç¤¾</span>
  </a>
</nav>

<body>
  

<!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
<header class="header">
  <div class="header-left">
    <img src="https://irukatrin.dolphin.f5.si/favicon.ico" alt="ãƒ­ã‚´" class="logo" />
    <span class="site-name">ã„ã‚‹ã‹é›»é‰„</span>
  </div>
  <div class="menu-toggle" onclick="toggleMenu()">
    <span></span>
    <span></span>
    <span></span>
  </div>
  <nav class="header-right" id="menu">
    <a href="#">ãƒ›ãƒ¼ãƒ </a>
    <a href="unkou">é‹è¡Œæƒ…å ±</a>
    <a href="irukaSNS.html">è»Šä¸¡åˆ©ç”¨</>
    <a href="#">ãƒã‚±ãƒƒãƒˆ</a>
    <a href="Pack">ä¼šç¤¾æ¦‚è¦</a>
    
  </nav>
</header>
  

<div class="railinfo-alert" id="rail-status-box">
  <p id="rail-status"><img src="https://cdn.glitch.global/222e2a02-bde1-49d3-9324-5d9cc0f0d234/%E5%90%8D%E7%A7%B0%E6%9C%AA%E8%A8%AD%E5%AE%9A%E3%81%AE%E3%83%87%E3%82%B6%E3%82%A4%E3%83%B3%20(5).png?v=1744802974338" alt="Delay Icon"> ç¾åœ¨ã®æ™‚é–“é‹è¡Œã—ã¦ã„ã¾ã›ã‚“ã€‚ã€‚</p>
  <span class="time" id="current-time"></span>
</div>


    <span class="time" id="current-time"></span></div>
<div class="railinfo-announce-area" id="railinfo-announce-area">
  <!-- JSã§ã‚¢ãƒŠã‚¦ãƒ³ã‚¹ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ -->
</div>



<div class="topimage">
  <div class="image-container">
    <img src="https://irukatrin.dolphin.f5.si/image/Irukaweb%20-%202.png" alt="è¢«ã›ç”»åƒ" class="overlay-img">
    <form class="search-form" id="stationSearchForm" autocomplete="off">
      <input type="text" id="stationInput" placeholder="é§…åæ¤œç´¢ã€€å¯¾å¿œkamuié‰„é“ãƒ»ã•ã•é›»é‰„ãƒ»ã„ã‚‹ã‹é›»é‰„" />
      <div id="suggestions" class="suggestions"></div>
      <button type="submit">é§…å</button>
    </form>
  </div>
</div>
  
  

<!-- ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ -->
<div class="slider" id="slider">
  <div class="slider-track" id="sliderTrack">
    <img src="https://raw.githubusercontent.com/kansinline/irukatrin.github.io/refs/heads/main/image/IMG_0979.png" alt="ç”»åƒ1">
    <img src="https://raw.githubusercontent.com/kansinline/irukatrin.github.io/refs/heads/main/image/IMG_0980.png" alt="ç”»åƒ2">
    <img src="https://raw.githubusercontent.com/kansinline/irukatrin.github.io/refs/heads/main/image/IMG_0980.png" alt="ç”»åƒ3">
  </div>
  <button class="slider-btn prev-btn" onclick="slidePrev()">â€¹</button>
  <button class="slider-btn next-btn" onclick="slideNext()">â€º</button>
</div>

<!-- ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ -->
<div class="info-tabs">
  <div class="tab-buttons">
    <button class="tab-button active" data-tab="news">ãŠçŸ¥ã‚‰ã›</button>
    <button class="tab-button" data-tab="release">ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒªãƒªãƒ¼ã‚¹</button>
  </div>

  <div class="tab-content active" id="news">

  </div>

  <div class="tab-content" id="release">
    <ul>
      <li>ã„ã‚‹ã‹é›»é‰„ãƒ‡ã‚¶ã‚¤ãƒ³æ”¹æ­£</li>
    </ul>
  </div>
</div>

<!-- ç‰¹é›† -->
<section class="feature-section">
  <h2 class="feature-title">ã„ã‚‹ã‹é›»é‰„ã‚’çŸ¥ã‚‹ãƒ»æ¥½ã—ã‚€</h2>
  <div class="feature-content">
    <button class="feature-box">
      <img src="https://irukatrin.dolphin.f5.si/favicon.ico" alt="ç‰¹å¾´1">
      <p>è»Šä¸¡å›³é‘‘</p>
    </button>
    <button class="feature-box">
      <img src="img/logo.png" alt="ç‰¹å¾´2">
      <p>è¦³å…‰åˆ—è»Šãƒ»ä½“é¨“</p>
    </button>
    <button class="feature-box">
      <img src="sample3.jpg" alt="ç‰¹å¾´3">
      <p>ã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±</p>
    </button>
  </div>
</section>
  

<!-- SNSä¸€è¦§ -->
<section class="sns-hankyu">
  <h2>å…¬å¼ã‚µã‚¤ãƒˆãƒ»SNSä¸€è¦§</h2>
  <div class="sns-cards">
    <a href="https://example.com" class="sns-card" target="_blank">å…¬å¼ã‚µã‚¤ãƒˆ</a>
    <a href="https://twitter.com" class="sns-card" target="_blank">Xï¼ˆæ—§Twitterï¼‰</a>
    <a href="https://instagram.com" class="sns-card" target="_blank">Instagram</a>
  </div>
</section>
  <section class="sns-hankyu">
  <h2>Â©2025- iruka Railway. All right Reserved.</h2>
</section>

<!-- JavaScript -->
<script>
/* ===============================
   ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ï¼šã‚¹ãƒ¯ã‚¤ãƒ—å¯¾å¿œ
================================ */
let startX = 0;
let isSwiping = false;

const slider = document.getElementById("slider");

slider.addEventListener("touchstart", function (e) {
  startX = e.touches[0].clientX;
  isSwiping = true;
  stopAutoSlide();
});

slider.addEventListener("touchmove", function (e) {
  if (!isSwiping) return;
  const diff = e.touches[0].clientX - startX;

  // å°‘ã—ã§ã‚‚æ¨ªç§»å‹•ã—ãŸã‚‰ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«é˜²æ­¢
  if (Math.abs(diff) > 10) {
    e.preventDefault();
  }
}, { passive: false });

slider.addEventListener("touchend", function (e) {
  if (!isSwiping) return;

  const endX = e.changedTouches[0].clientX;
  const diff = endX - startX;

  if (diff > 50) {
    slidePrev(); // å³ã‚¹ãƒ¯ã‚¤ãƒ—
  } else if (diff < -50) {
    slideNext(); // å·¦ã‚¹ãƒ¯ã‚¤ãƒ—
  }

  isSwiping = false;
  startAutoSlide();
});

async function checkTrainStatus() {
  try {
    const response = await fetch("https://irukarailwayapi.onrender.com/trains");
    const trains = await response.json();

    const box = document.getElementById("rail-status-box");
    const statusText = document.getElementById("rail-status");

    if (!box || !statusText) return;

    const hasCancel = trains.some(train => train.status && train.status.includes("é‹ä¼‘"));

    if (hasCancel) {
      // é‹ä¼‘ã‚ã‚Š
      statusText.innerHTML = "âŒ ä¸€éƒ¨ã®åˆ—è»ŠãŒé‹ä¼‘ã—ã¦ã„ã¾ã™ã€‚";
      box.style.backgroundColor = "#ffe6e6"; // è–„èµ¤
      box.style.borderColor = "#ff4d4d";     // èµ¤ã„æ 
      statusText.querySelector("img")?.remove(); // ç”»åƒå‰Šé™¤ï¼ˆä»»æ„ï¼‰
    } else {
      // é‹è¡Œä¸­
      statusText.innerHTML = "âœ… ç¾åœ¨é‹è¡Œã—ã¦ã„ã¾ã™ã€‚";
      box.style.backgroundColor = "#f8f8f8"; // å…ƒã®èƒŒæ™¯
      box.style.borderColor = "#e4e4e4";     // å…ƒã®æ 
      // å¿…è¦ãªã‚‰ã‚¢ã‚¤ã‚³ãƒ³ã‚’æˆ»ã™
      const img = document.createElement("img");
      img.src = "https://cdn.glitch.global/222e2a02-bde1-49d3-9324-5d9cc0f0d234/%E5%90%8D%E7%A7%B0%E6%9C%AA%E8%A8%AD%E5%AE%9A%E3%81%AE%E3%83%87%E3%82%B6%E3%82%A4%E3%83%B3%20(5).png?v=1744802974338";
      img.alt = "Delay Icon";
      img.style.width = "24px";
      img.style.height = "24px";
      img.style.marginRight = "10px";
      statusText.prepend(img);
    }

  } catch (err) {
    console.error("é‹è¡Œæƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ:", err);
  }
}

// åˆå›ãƒã‚§ãƒƒã‚¯ï¼‹å®šæœŸãƒã‚§ãƒƒã‚¯ï¼ˆ1åˆ†ã”ã¨ï¼‰
checkTrainStatus();
setInterval(checkTrainStatus, 60000);



  // åˆå›ãƒã‚§ãƒƒã‚¯ï¼‹å®šæœŸãƒã‚§ãƒƒã‚¯ï¼ˆ1åˆ†ã”ã¨ï¼‰
  checkTrainStatus();
  window.onload = function() {
    var currentTime = new Date();
    var formattedTime = currentTime.getFullYear() + "å¹´" +
                        (currentTime.getMonth() + 1) + "æœˆ" +
                        currentTime.getDate() + "æ—¥ " +
                        currentTime.getHours() + "æ™‚" +
                        currentTime.getMinutes() + "åˆ† ç¾åœ¨";
    document.getElementById('current-time').textContent = formattedTime;
};
  // é§…åã¨ãƒ­ãƒ¼ãƒå­—ã®ãƒãƒƒãƒ—
  const stationRomajiMap = {
    "ã„ã‚‹ã‹å²¬": "irukamisaki",
    "ãƒãƒãƒ«æ‘(ã„ã‚‹ã‹é›»é‰„)": "maharumura_iruka",
    "ãƒãƒãƒ«æ‘(ã•ã•é›»é‰„)": "maharumura_sasa",
    "æ–°æ‹ ç‚¹æ±": "shinkyotenhigashi",
    "æ‹ ç‚¹": "kyoten_kamui",
    "ç•‘å±±": "hatayeyama",
    "å¹³é‡": "heiya",
    "æµ·å´": "umisaki",
    "å‡ºå³¶": "dezima",
    "æ²¼åœ°": "numati",
    "æ–°æ‹ ç‚¹(å³°å·ç·š)":"Sinkyoten_minekawa",
    "æ²¼æ˜¥":"numaharu",
    "æ²¼é‡Œ":"numazato",
    "å±±è°·æ£®ä¸­":"yamatanisintyu",
    "å³¯å·":"minekawa",
    "æ‹ ç‚¹(ä½ç”°æµ·æ´‹é‰„é“)":"kyoten_sada",
    "é«˜é‡(ä½ç”°æµ·æ´‹é‰„é“)":"takano",
    "æ–°æ‹ ç‚¹(ä½ç”°æµ·æ´‹é‰„é“)":"sinkyoten_sada",
    "ãƒãƒãƒ«æ‘":"maharumura_sada",
    "æ–°æ‹ ç‚¹(kamui)":"Sinkyoten-kamui"
  };

  const input = document.getElementById("stationInput");
  const suggestions = document.getElementById("suggestions");

  // å…¥åŠ›æ™‚ã®ã‚µã‚¸ã‚§ã‚¹ãƒˆè¡¨ç¤º
  input.addEventListener("input", function () {
    const value = this.value.toLowerCase();
    suggestions.innerHTML = "";
    if (value === "") return;

    const stationList = Object.keys(stationRomajiMap);
    const filtered = stationList.filter(station =>
      station.toLowerCase().includes(value)
    );

    filtered.forEach(station => {
      const div = document.createElement("div");
      div.textContent = station;
      div.addEventListener("click", function () {
        input.value = station;
        suggestions.innerHTML = "";
      });
      suggestions.appendChild(div);
    });
  });

  // å¤–éƒ¨ã‚¯ãƒªãƒƒã‚¯ã§ã‚µã‚¸ã‚§ã‚¹ãƒˆéè¡¨ç¤º
  document.addEventListener("click", function (e) {
    if (!document.getElementById("stationSearchForm").contains(e.target)) {
      suggestions.innerHTML = "";
    }
  });

  // é§…åæ¤œç´¢é€ä¿¡ã‚¤ãƒ™ãƒ³ãƒˆ
  const form = document.getElementById('stationSearchForm');
  form.addEventListener('submit', function(e) {
    e.preventDefault();
    const stationName = input.value.trim();
    const romaji = stationRomajiMap[stationName];

    if (romaji) {
      window.location.href = `https://irukatrin.dolphin.f5.si/station/${romaji}`;
    } else {
      alert("å…¥åŠ›ã•ã‚ŒãŸé§…åãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚");
    }
  });

  // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ©Ÿèƒ½
  const track = document.getElementById('sliderTrack');
  const slides = track.querySelectorAll('img');
  let currentIndex = 0;
  let intervalId;

  function updateSlide() {
    const slideWidth = slides[0].clientWidth;
    track.style.transform = `translateX(-${slideWidth * currentIndex}px)`;
  }

  function slideNext() {
    currentIndex = (currentIndex + 1) % slides.length;
    updateSlide();
  }

  function slidePrev() {
    currentIndex = (currentIndex - 1 + slides.length) % slides.length;
    updateSlide();
  }

  function startAutoSlide() {
    intervalId = setInterval(slideNext, 3000);
  }

  function stopAutoSlide() {
    clearInterval(intervalId);
  }

  startAutoSlide();
  document.getElementById('slider').addEventListener('mouseenter', stopAutoSlide);
  document.getElementById('slider').addEventListener('mouseleave', startAutoSlide);
  window.addEventListener('resize', updateSlide);

  // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
  const buttons = document.querySelectorAll('.tab-button');
  const contents = document.querySelectorAll('.tab-content');

  buttons.forEach(button => {
    button.addEventListener('click', () => {
      const target = button.dataset.tab;
      buttons.forEach(btn => btn.classList.remove('active'));
      contents.forEach(content => content.classList.remove('active'));
      button.classList.add('active');
      
document.getElementById(target).classList.add('active');
    });
  });
/* ===============================
   å‹•çš„ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€å‡¦ç†
================================ */
function applyDynamicText(text) {
  const now = new Date();
  const year = now.getFullYear();
  const month = now.getMonth() + 1;
  const day = now.getDate();
  const hour = now.getHours();
  const min = String(now.getMinutes()).padStart(2, "0");

  return text
    .replace(/{{YEAR}}/g, year)
    .replace(/{{MONTH}}/g, month)
    .replace(/{{DAY}}/g, day)
    .replace(/{{TIME}}/g, `${hour}:${min}`);
}

function applyAnniversary(text, openYear) {
  const now = new Date();
  const anniversary = now.getFullYear() - openYear;
  return text.replace(/{{ANNIVERSARY}}/g, anniversary);
}

/* ===============================
   ã‚¢ãƒŠã‚¦ãƒ³ã‚¹å®šç¾©
================================ */
const announceEvents = [
{
    level: "normal",
    repeat: "yearly",
    start: "01-01T00:00",
    end: "01-01T23:59",
    message_ja: "{{YEAR}}å¹´ ã‚ã‘ã¾ã—ã¦ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ã€‚æœ¬å¹´ã‚‚ã„ã‚‹ã‹é›»é‰„ã‚’ã”åˆ©ç”¨ãã ã•ã„ã€‚",
    message_en: "Happy New Year {{YEAR}}. Thank you for using Iruka Railway."
  },
  {
    level: "normal",
    repeat: "always",
    message_ja: "ã„ã‚‹ã‹é›»é‰„ã¯é–‹æ¥­{{ANNIVERSARY}}å‘¨å¹´ã‚’è¿ãˆã¾ã—ãŸã€‚",
    message_en: "Iruka Railway celebrates its {{ANNIVERSARY}}th anniversary.",
    openYear: 2025
  },
  {
    level: "emergency",
    repeat: "always",
    message_ja: "ã„ã¤ã‚‚ã‚¤ãƒ«ã‚«é›»é‰„ã‚’ã”åˆ©ç”¨é ‚ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ã‚¢ã‚¤ãƒ†ãƒ ã‚’è»Šå†…ã§æŠ•ã’ã‚‹è¡Œç‚ºã¯ã€ã‚µãƒ¼ãƒãƒ¼ã‚’ãƒ©ã‚°ãã™ã‚‹åŸå› ã«ãªã‚‹ã®ã§ã‚„ã‚ã¾ã—ã‚‡ã†",
    message_en: "Thank you for using Iruka Dentetsu. Please refrain from throwing items inside the train as it may cause server lag.",
  }
];

/* ===============================
   æ™‚é–“åˆ¤å®šï¼ˆyearlyå¯¾å¿œï¼‰
================================ */
function isInTime(event, now) {
  if (event.repeat === "always") return true;

  let start, end;

  if (event.repeat === "yearly") {
    const y = now.getFullYear();
    start = new Date(`${y}-${event.start}`);
    end = new Date(`${y}-${event.end}`);
  } else {
    start = new Date(event.start);
    end = new Date(event.end);
  }

  return now >= start && now <= end;
}

/* ===============================
   ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« â†’ çµ‚äº†å¾Œã«è¨€èªåˆ‡æ›¿
================================ */
function startScrollThenSwitch(textEl, wrapEl, ja, en) {
  let x = wrapEl.clientWidth;
  let lang = "ja";
  const speed = 1.5;
  let waiting = false;

  function loop() {
    if (!waiting) {
      x -= speed;
      textEl.style.transform = `translateX(${x}px)`;

      if (x < -textEl.scrollWidth) {
        waiting = true;
        setTimeout(() => {
          lang = lang === "ja" ? "en" : "ja";
          textEl.textContent = lang === "ja" ? ja : en;
          x = wrapEl.clientWidth;
          waiting = false;
        }, 1000);
      }
    }
    requestAnimationFrame(loop);
  }
  loop();
}

/* ===============================
   çŸ­æ–‡ç”¨ï¼šå…¨æ–‡åˆ‡æ›¿
================================ */
function startShortSwitch(textEl, ja, en) {
  let lang = "ja";
  setInterval(() => {
    lang = lang === "ja" ? "en" : "ja";
    textEl.textContent = lang === "ja" ? ja : en;
  }, 5000);
}

/* ===============================
   ãƒ¡ã‚¤ãƒ³æç”»å‡¦ç†
================================ */
function checkAnnounceMultiple() {
  const now = new Date();
  const area = document.getElementById("railinfo-announce-area");
  area.innerHTML = "";

  announceEvents.forEach(event => {
    if (!isInTime(event, now)) return;

    let ja = applyDynamicText(event.message_ja);
    let en = applyDynamicText(event.message_en);

    if (event.openYear) {
      ja = applyAnniversary(ja, event.openYear);
      en = applyAnniversary(en, event.openYear);
    }

    const box = document.createElement("div");
    box.className = `railinfo-announce announce-${event.level}`;

    const icon = document.createElement("span");
    icon.className = "icon";
    icon.textContent =
      event.level === "emergency" ? "ğŸš¨" :
      event.level === "caution"   ? "âš ï¸" : "ğŸ“¢";

    const wrap = document.createElement("div");
    wrap.className = "announce-text-wrap";

    const text = document.createElement("div");
    text.className = "announce-text";
    text.textContent = ja;

    wrap.appendChild(text);
    box.appendChild(icon);
    box.appendChild(wrap);
    area.appendChild(box);

    requestAnimationFrame(() => {
      if (text.scrollWidth > wrap.clientWidth) {
        startScrollThenSwitch(text, wrap, ja, en);
      } else {
        startShortSwitch(text, ja, en);
      }
    });
  });
}

/* ===============================
   èµ·å‹•
================================ */
checkAnnounceMultiple();
setInterval(checkAnnounceMultiple, 60000);
</script>

</body>
</html>
















